{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
      {% block page_title %}
      {% endblock page_title %}
    </title>
    <meta name="description" content="Start your coding journey with goOJ">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}"
          rel="stylesheet" />
    <link href="{% static 'vendor/fontawesome/css/all.min.css' %}"
          rel="stylesheet" />
    <script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'vendor/jquery/jquery.min.js' %}"></script>
    {% block link_css %}
    {% endblock link_css %}
  </head>
  <body>
    <div class="container">
      <div class="row mt-2">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
          <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/" style="font-size: 1.5rem;">
              <i class="fas fa-rocket" style="color: #f093fb;"></i>
              <span style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Lets</span><span style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">OJ</span>
            </a>
            <button class="navbar-toggler"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#navbarNavDropdown"
                    aria-controls="navbarNavDropdown"
                    aria-expanded="false"
                    aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'contest_list' %}">
                    <i class="fas fa-tasks" style="color: #f093fb;"></i> 繳交作業或參加競賽
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'user_contests_summary' %}">
                    <i class="fas fa-chart-line" style="color: #43e97b;"></i> 我的積分
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'oj_about' %}">
                    <i class="fas fa-question-circle" style="color: #4facfe;"></i> 使用說明
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'learning_map' %}">
                    <i class="fas fa-map" style="color: #fa709a;"></i> 程式學習地圖
                  </a>
                </li>
                {% if user.is_staff %}
                  <li class="nav-item">
                    <a class="nav-link" href="{% url 'home_management' %}" target='_blank'>
                      <i class="fas fa-user-shield" style="color: #667eea;"></i> 到管理者首頁
                    </a>
                  </li>
                {% endif %}
              </ul>
              <ul class="navbar-nav ms-auto">
                {% if user.is_authenticated %}
                  <li class="nav-item d-flex align-items-center">
                    <span class="me-3" style="padding: 5px 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px; color: white; font-weight: 500;">
                      <i class="fas fa-user-graduate me-2" style="font-size: 18px;"></i>
                      {{ user.full_name|title }}
                    </span>
                    <a class="btn btn-sm btn-outline-warning me-2"
                       href="{% url 'custom_change_password' %}"
                       role="button">
                      <i class="fas fa-key me-1"></i>修改密碼
                    </a>
                    <a class="btn btn-sm btn-outline-danger"
                       href="{% url 'logout' %}"
                       role="button">
                      <i class="fas fa-sign-out-alt me-1"></i>登出
                    </a>
                  </li>
                {% else %}
                  <li class="nav-item d-flex align-items-center">
                    <a class="btn btn-sm btn-outline-primary me-2"
                       href="{% url 'user_login' %}"
                       role="button">
                      <i class="fas fa-sign-in-alt me-1"></i>登入
                    </a>
                    <a class="btn btn-sm btn-outline-success"
                       href="{% url 'user_register' %}"
                       role="button">
                      <i class="fas fa-user-plus me-1"></i>註冊
                    </a>
                  </li>
                {% endif %}
              </ul>
        </div>
      </div>
    </nav>
    <!-- end of navigation -->
    <!-- messages -->
    <div class="row mt-3">
      {% if messages %}
        {% for message in messages %}
          {% if 'error' in message.tags %}
            <p class="alert alert-danger bg-light text-danger" role="alert">
              <span style="font-weight:bold">{{ message }}</span>
            </p>
          {% elif 'success' in message.tags %}
            <p class="alert alert-success bg-light text-success" role="alert">
              <span style="font-weight:bold">{{ message }}</span>
            </p>
          {% else %}
            <p class="alert alert-warning bg-info text-primary" role="alert">
              <span style="font-weight:bold">{{ message }}</span>
            </p>
          {% endif %}
        {% endfor %}
      {% endif %}
    </div>
    <!-- messages -->
  </div>
  {% block page_content %}
  {% endblock page_content %}
</div>
</body>
</html>
{% block script_block %}
  <script>
  //close alert after 3 seconds
  window.setTimeout(function() {
    $(".alert").fadeTo(300, 0).slideUp(300, function(){
      $(this).remove();
    });
  }, 2000);
  </script>
{% endblock script_block %}
